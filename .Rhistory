theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
# Find nearest free wifi spots with a computer to tract centroids
digit_vulnerable_centroids <- st_centroid(digit_vulnerable_philly)
nearest_wifi_spot_comp <- st_nearest_feature(digit_vulnerable_centroids, free_wifi_spots[free_wifi_spots$computers_=="Y",])
digit_vulnerable_philly <- digit_vulnerable_philly %>%
mutate(nearest_wifi_spot_geom = free_wifi_spots$geometry[nearest_wifi_spot_comp])
digit_vulnerable_philly <- digit_vulnerable_philly %>%
mutate(distance_wifi_spot_comp = set_units(st_distance(digit_vulnerable_centroids, digit_vulnerable_philly$nearest_wifi_spot_geom, by_element = TRUE), "mi"))
summary(digit_vulnerable_philly$distance_wifi_spot_comp)
#Find walking distance buffers around free wifi spots with computers
free_wifi_buffers <- free_wifi_spots %>%
filter(computers_=="Y" & to_display=="ACTIVE")%>%
st_buffer(dist = 2640)  # 2640 ft = .5 mi
#dissolve overlapping buffers
free_wifi_buffers_dissolve <- free_wifi_buffers%>%
st_union() %>%
st_cast("POLYGON")%>%
st_as_sf()%>%
mutate(
legend= ".5 mi from Free Wifi Spot w Computer"
)
#examine buffers and tracts overlap
ggplot(philly_digital_access)+
geom_sf(
color="darkgray",
linewidth=.5,
alpha=.5
)+
geom_sf(
data=digit_vulnerable_philly,
aes(fill=percent_no_bb+percent_no_comp)
)+
scale_fill_gradient(
low="#FFCF33",
high="#F53D00",
name=str_wrap("Digital Vulnerability (higher number is more vulnerable)",30)
)+
new_scale_fill()+
geom_sf(
data=free_wifi_buffers_dissolve,
aes(fill=legend),
color="black",
linewidth=.8,
alpha=0.4
)+
scale_color_manual(
values = c(".5 mi from Free Wifi Spot w Computer" =  "#F5A6E6") ,
name=NULL
)+
theme_void()+
labs(
title = str_wrap("Degree of Digital Vulnerability and Walking Distance to Public WiFi & Computer",50),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
guides(fill = guide_legend(title = NULL))+
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
overlap <- st_intersects(digit_vulnerable_philly, free_wifi_buffers)
no_overlap <- lengths(overlap) == 0
digit_underserved <- digit_vulnerable_philly[no_overlap, ]
summary(digit_underserved)
#note, the sum of estiamated households without computer and without broadband is not an accurate estimate of reality because those without one are likely overlapping with the other. This metric is just being used to create a metric showing reflecting broadband and computer need in one.
digit_underserved<-digit_underserved%>%
mutate(
digit_need_heuristic = (total_hhE - has_computerE)+(total_hhE - has_broadbandE)
)
top_10_digit_underserved <- digit_underserved%>%
arrange(desc(digit_need_heuristic))%>%
slice_head(n = 10)
top_10_digit_underserved %>%
st_drop_geometry()%>%
select(c(
"NAMELSAD",
"percent_no_bb",
"percent_no_comp",
"median_incomeE",
"distance_wifi_spot_comp"
)) %>%
kable(
col.names = c("Census Tract",
"Percent w/o Broadband",
"Percent w/o a Computer",
"Median Income",
"Distance to Free Wi-Fi spot w/ Computer"),
digits = 1,
format.args = list(big.mark = ","),
align = "l",
caption = "10 Census Tracts in Philadelphia that have Highest Digitally Vulnerable Population"
)
#Map the underserved tracts and wifi spots buffers
digit_underserved<-digit_underserved%>%
mutate(
legend="Digitally Underserved Tract"
)
ggplot(philly_digital_access)+
geom_sf(
color="darkgray",
linewidth=.5,
alpha=.5
)+
geom_sf(
data=digit_underserved,
aes(fill="Digitally Underserved Tract")
)+
scale_fill_manual(
values = c("Digitally Underserved Tract" = "#3F88C5"),
name=NULL
)+
new_scale_fill()+
geom_sf(
data=free_wifi_buffers_dissolve,
aes(fill=".5 mi from Free Wifi Spot w Computer"),
color="black",
linewidth=.8,
alpha=0.4
)+
scale_color_manual(
values = c(".5 mi from Free Wifi Spot w Computer" =  "#F5A6E6")
)+
guides(fill = guide_legend(title = NULL))+
theme_void()+
labs(
title = str_wrap("Digitally Underserved Tracts in Philadelphia ",40),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
guides(fill = guide_legend(title = NULL))+
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
digit_vulnerable_philly <- philly_digital_access %>%
filter(percent_no_bb>=17.514 | percent_smart_only>=15.765 )%>%
mutate(Vulnerable="Digtally Vulnerable Tract")
#visually examine digitally vulnerable tracts and free wifi spots with computers
ggplot(philly_digital_access)+
geom_sf()+
geom_sf(
data=digit_vulnerable_philly,
aes(fill=Vulnerable)
)+
scale_fill_manual(
values=c("Digtally Vulnerable Tract" = "purple")
)+
geom_sf(data=free_wifi_spots[free_wifi_spots$computers_=="Y",])+
theme_void()+
labs(
title = str_wrap("Digitally Vulnerable Tracts and Free Wifi Spots with a Computer in Philadelphia",70),
subtitle = str_wrap("Where a vulnerable tract is one where 17.514% or more of households do not have home broadband or 15.765% or more of households do not have a computer",60),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
#examine buffers and tracts overlap
ggplot(philly_digital_access)+
geom_sf(
color="darkgray",
linewidth=.5,
alpha=.5
)+
geom_sf(
data=digit_vulnerable_philly,
aes(fill=percent_no_bb+percent_smart_only)
)+
scale_fill_gradient(
low="#FFCF33",
high="#F53D00",
name=str_wrap("Digital Vulnerability (higher number is more vulnerable)",30)
)+
new_scale_fill()+
geom_sf(
data=free_wifi_buffers_dissolve,
aes(fill=legend),
color="black",
linewidth=.8,
alpha=0.4
)+
scale_color_manual(
values = c(".5 mi from Free Wifi Spot w Computer" =  "#F5A6E6") ,
name=NULL
)+
theme_void()+
labs(
title = str_wrap("Degree of Digital Vulnerability and Walking Distance to Public WiFi & Computer",50),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
guides(fill = guide_legend(title = NULL))+
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
overlap <- st_intersects(digit_vulnerable_philly, free_wifi_buffers)
no_overlap <- lengths(overlap) == 0
digit_underserved <- digit_vulnerable_philly[no_overlap, ]
summary(digit_underserved)
View(digit_vulnerable_philly)
summary(philly_digital_access$percent_smart_only)
digit_vulnerable_philly <- philly_digital_access %>%
filter(percent_no_bb>=17.514 & percent_smart_only>=15.765 )%>%
mutate(Vulnerable="Digtally Vulnerable Tract")
View(digit_vulnerable_philly)
#visually examine digitally vulnerable tracts and free wifi spots with computers
ggplot(philly_digital_access)+
geom_sf()+
geom_sf(
data=digit_vulnerable_philly,
aes(fill=Vulnerable)
)+
scale_fill_manual(
values=c("Digtally Vulnerable Tract" = "purple")
)+
geom_sf(data=free_wifi_spots[free_wifi_spots$computers_=="Y",])+
theme_void()+
labs(
title = str_wrap("Digitally Vulnerable Tracts and Free Wifi Spots with a Computer in Philadelphia",70),
subtitle = str_wrap("Where a vulnerable tract is one where 17.514% or more of households do not have home broadband or 15.765% or more of households do not have a computer",60),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
digit_vulnerable_philly <- philly_digital_access %>%
filter(percent_no_bb>=17.514 | percent_smart_only>=15.765 )%>%
mutate(Vulnerable="Digtally Vulnerable Tract")
#visually examine digitally vulnerable tracts and free wifi spots with computers
ggplot(philly_digital_access)+
geom_sf()+
geom_sf(
data=digit_vulnerable_philly,
aes(fill=Vulnerable)
)+
scale_fill_manual(
values=c("Digtally Vulnerable Tract" = "purple")
)+
geom_sf(data=free_wifi_spots[free_wifi_spots$computers_=="Y",])+
theme_void()+
labs(
title = str_wrap("Digitally Vulnerable Tracts and Free Wifi Spots with a Computer in Philadelphia",70),
subtitle = str_wrap("Where a vulnerable tract is one where 17.514% or more of households do not have home broadband or 15.765% or more of households do not have a computer",60),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
digit_underserved
colnames(digit_underserved)
#note, the sum of estiamated households without computer and without broadband is not an accurate estimate of reality because those without one are likely overlapping with the other. This metric is just being used to create a metric showing reflecting broadband and computer need in one.
digit_underserved<-digit_underserved%>%
mutate(
digit_need_heuristic = (total_hhE - smartphone_onlyE)+(total_hhE - has_broadbandE)
)
top_10_digit_underserved <- digit_underserved%>%
arrange(desc(digit_need_heuristic))%>%
slice_head(n = 10)
top_10_digit_underserved %>%
st_drop_geometry()%>%
select(c(
"NAMELSAD",
"percent_no_bb",
"percent_no_comp",
"median_incomeE",
"distance_wifi_spot_comp"
)) %>%
kable(
col.names = c("Census Tract",
"Percent w/o Broadband",
"Percent w/o a Computer",
"Median Income",
"Distance to Free Wi-Fi spot w/ Computer"),
digits = 1,
format.args = list(big.mark = ","),
align = "l",
caption = "10 Census Tracts in Philadelphia that have Highest Digitally Vulnerable Population"
)
colnames(digit_underserved)
top_10_digit_underserved %>%
st_drop_geometry()%>%
select(c(
"NAMELSAD",
"percent_no_bb",
"percent_smart_only",
"median_incomeE",
"distance_wifi_spot_comp"
)) %>%
kable(
col.names = c("Census Tract",
"Percent w/o Broadband",
"Percent w/o Smartphone Only",
"Median Income",
"Distance to Free Wi-Fi spot w/ Computer"),
digits = 1,
format.args = list(big.mark = ","),
align = "l",
caption = "10 Census Tracts in Philadelphia that have Highest Digitally Vulnerable Population"
)
# Find nearest free wifi spots with a computer to tract centroids
digit_vulnerable_centroids <- st_centroid(digit_vulnerable_philly)
nearest_wifi_spot_comp <- st_nearest_feature(digit_vulnerable_centroids, free_wifi_spots[free_wifi_spots$computers_=="Y",])
digit_vulnerable_philly <- digit_vulnerable_philly %>%
mutate(nearest_wifi_spot_geom = free_wifi_spots$geometry[nearest_wifi_spot_comp])
digit_vulnerable_philly <- digit_vulnerable_philly %>%
mutate(distance_wifi_spot_comp = set_units(st_distance(digit_vulnerable_centroids, digit_vulnerable_philly$nearest_wifi_spot_geom, by_element = TRUE), "mi"))
summary(digit_vulnerable_philly$distance_wifi_spot_comp)
#Find walking distance buffers around free wifi spots with computers
free_wifi_buffers <- free_wifi_spots %>%
filter(computers_=="Y" & to_display=="ACTIVE")%>%
st_buffer(dist = 2640)  # 2640 ft = .5 mi
#dissolve overlapping buffers
free_wifi_buffers_dissolve <- free_wifi_buffers%>%
st_union() %>%
st_cast("POLYGON")%>%
st_as_sf()%>%
mutate(
legend= ".5 mi from Free Wifi Spot w Computer"
)
#examine buffers and tracts overlap
ggplot(philly_digital_access)+
geom_sf(
color="darkgray",
linewidth=.5,
alpha=.5
)+
geom_sf(
data=digit_vulnerable_philly,
aes(fill=percent_no_bb+percent_smart_only)
)+
scale_fill_gradient(
low="#FFCF33",
high="#F53D00",
name=str_wrap("Digital Vulnerability (higher number is more vulnerable)",30)
)+
new_scale_fill()+
geom_sf(
data=free_wifi_buffers_dissolve,
aes(fill=legend),
color="black",
linewidth=.8,
alpha=0.4
)+
scale_color_manual(
values = c(".5 mi from Free Wifi Spot w Computer" =  "#F5A6E6") ,
name=NULL
)+
theme_void()+
labs(
title = str_wrap("Degree of Digital Vulnerability and Walking Distance to Public WiFi & Computer",50),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
guides(fill = guide_legend(title = NULL))+
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
overlap <- st_intersects(digit_vulnerable_philly, free_wifi_buffers)
no_overlap <- lengths(overlap) == 0
digit_underserved <- digit_vulnerable_philly[no_overlap, ]
summary(digit_underserved)
#note, the sum of estiamated households without computer and without broadband is not an accurate estimate of reality because those without one are likely overlapping with the other. This metric is just being used to create a metric showing reflecting broadband and computer need in one.
digit_underserved<-digit_underserved%>%
mutate(
digit_need_heuristic = (total_hhE - smartphone_onlyE)+(total_hhE - has_broadbandE)
)
top_10_digit_underserved <- digit_underserved%>%
arrange(desc(digit_need_heuristic))%>%
slice_head(n = 10)
top_10_digit_underserved %>%
st_drop_geometry()%>%
select(c(
"NAMELSAD",
"percent_no_bb",
"percent_smart_only",
"median_incomeE",
"distance_wifi_spot_comp"
)) %>%
kable(
col.names = c("Census Tract",
"Percent w/o Broadband",
"Percent w/o Smartphone Only",
"Median Income",
"Distance to Free Wi-Fi spot w/ Computer"),
digits = 1,
format.args = list(big.mark = ","),
align = "l",
caption = "10 Census Tracts in Philadelphia that have Highest Digitally Vulnerable Population"
)
#Map the underserved tracts and wifi spots buffers
digit_underserved<-digit_underserved%>%
mutate(
legend="Digitally Underserved Tract"
)
ggplot(philly_digital_access)+
geom_sf(
color="darkgray",
linewidth=.5,
alpha=.5
)+
geom_sf(
data=digit_underserved,
aes(fill="Digitally Underserved Tract")
)+
scale_fill_manual(
values = c("Digitally Underserved Tract" = "#3F88C5"),
name=NULL
)+
new_scale_fill()+
geom_sf(
data=free_wifi_buffers_dissolve,
aes(fill=".5 mi from Free Wifi Spot w Computer"),
color="black",
linewidth=.8,
alpha=0.4
)+
scale_color_manual(
values = c(".5 mi from Free Wifi Spot w Computer" =  "#F5A6E6")
)+
guides(fill = guide_legend(title = NULL))+
theme_void()+
labs(
title = str_wrap("Digitally Underserved Tracts in Philadelphia ",40),
caption ="Data Sources: US Census Data, OpenDataPhilly"
) +
annotation_north_arrow(
location = "br",
which_north = "true",
style = north_arrow_minimal
) +
theme_void() +
guides(fill = guide_legend(title = NULL))+
theme(
legend.position = "right",
legend.direction = "vertical",
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 12),
plot.caption = element_text(hjust = 0.5, size = 9, margin = margin(t = 10))
)
sum(digit_underserved$smartphone_onlyE)
sum(philly_digital_access$smartphone_onlyE)
sum(digit_underserved$smartphone_onlyE)/sum(philly_digital_access$smartphone_onlyE)
